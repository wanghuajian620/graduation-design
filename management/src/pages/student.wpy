<style lang="less">
::-webkit-scrollbar {
  width: 0px;
  height: 0px;
  color: transparent
}
</style>

<template>
  <view>
    <repeat for="{{essay}}" key="index" index="index" item="items">
      <view @tap="select" id="{{index}}">
        <thesis :item="items"></thesis>
      </view>
    </repeat>
  </view>
</template>

<script>
import wepy from 'wepy'

import Thesis from '../components/thesis'

export default class Student extends wepy.page {
  config = {
    navigationBarTitleText: '学生选题系统'
  }
  components = {
    thesis: Thesis
  }
  data = {
    essay: []
  }
  methods = {
    select(e) {
      let data = {
        id: this.essay[e.currentTarget.id].ID
      }
      console.log(data, 'ID')
      var header
      header = {
        'content-type': 'application/x-www-form-urlencoded',
        'cookie': wepy.getStorageSync('sessionid') // 读取cookie
      }
      wepy.request({
        url: 'http://192.168.0.100:8080/graduation/student/select',
        method: 'POST',
        header: header,
        data: {
          id: this.essay[e.currentTarget.id].ID
        },
        success(res) {
          console.log(res)
        }
      })
    }
  }
  onLoad() {
    let self = this
    var header
    header = {
      'content-type': 'application/x-www-form-urlencoded',
      'cookie': wepy.getStorageSync('sessionid') // 读取cookie
    }
    wepy.request({
      url: 'http://192.168.0.100:8080/graduation/student/get',
      method: 'GET',
      header: header,
      success(res) {
        console.log(res, '请求到的内容')
        self.essay = res.data.data
        self.setData({
          essay: res.data.data
        })
      }
    })
  }
}
</script>
